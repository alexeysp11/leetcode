# sqlinjection

SQL injection - это атака на безопасность веб-приложений, при которой злоумышленник вводит вредоносный SQL-код в поля ввода приложения, чтобы получить доступ к базе данных или выполнить нежелательные операции. SQL injection возникает, когда приложение не фильтрует или экранирует пользовательский ввод перед выполнением SQL-запросов к базе данных.

## Примеры SQL injection

### Удаление таблицы пользователей

Предположим, у нас есть форма входа на сайт, где пользователь вводит свой логин и пароль. Если приложение не защищено от SQL injection, злоумышленник может ввести в поле пароля следующий текст: `'; DROP TABLE Users; --`, что приведет к удалению таблицы `Users` из базы данных.

### Получение конфиденциальной информации

Злоумышленник может использовать SQL injection для извлечения конфиденциальной информации из базы данных, такой как данные пользователей, кредитные карты, пароли и другие чувствительные данные.

Ниже представлены более конкретные ситуации, когда может выполниться SQL injection для получения конфиденциальной информации:

1. Использование `UNION` оператора: Злоумышленник может внедрить `UNION` оператор в SQL запрос, чтобы объединить результаты двух запросов и получить данные из другой таблицы. Например, если злоумышленник введет следующее выражение в поле для ввода пароля: `' UNION SELECT username, password FROM users --`, то он сможет получить данные о пользователях и их паролях.

2. Использование функций SQL: Злоумышленник может использовать функции SQL, такие как `SUBSTRING()`, `CONCAT()`, или другие, чтобы извлечь конкретные данные из базы данных. Например, злоумышленник может ввести следующее выражение в поле для ввода пароля: `' OR SUBSTRING(password, 1, 1) = 'a' --`, чтобы извлечь все пароли, начинающиеся с символа `'a'`.

3. Обход фильтрации данных: Иногда разработчики могут не правильно настроить фильтрацию данных на уровне приложения, что позволяет злоумышленнику обойти защиту и получить доступ к конфиденциальным данным. Например, если приложение не проверяет входные данные на наличие специальных символов или не использует параметризованные запросы, то злоумышленник может успешно выполнить SQL injection.

Поэтому важно убедиться, что приложение правильно обрабатывает входные данные, использует параметризованные запросы и проводит адекватную фильтрацию данных, чтобы предотвратить возможность SQL injection и защитить конфиденциальную информацию пользователей.

### Изменение данных

Злоумышленник может использовать SQL injection для изменения данных в базе данных. Например, он может изменить баланс на счету пользователя или персональные данные.

### Удаление данных

Злоумышленник может использовать SQL injection для удаления данных из базы данных. Например, он может удалить записи пользователей или другую важную информацию.

### Выполнение произвольных команд

Злоумышленник может использовать SQL injection для выполнения произвольных команд на сервере базы данных. Например, он может выполнить команды для создания новых пользователей или таблиц, что может привести к нарушению безопасности и нежелательным изменениям в базе данных.

### Подбор паролей

Злоумышленник может использовать SQL injection для подбора паролей или проверки их корректности путем внедрения специальных SQL-запросов.

## Способы защиты

Для защиты от SQL injection рекомендуется использовать параметризованные запросы и подготавливать SQL-запросы заранее. Вот несколько способов защиты от SQL injection на примере SQL-кода и кода на C#:

1. Использование параметризованных запросов:
```C#
string query = "SELECT * FROM Users WHERE Username = @Username AND Password = @Password";
SqlCommand command = new SqlCommand(query, connection);
command.Parameters.AddWithValue("@Username", username);
command.Parameters.AddWithValue("@Password", password);
```

2. Использование хранимых процедур:
```sql
CREATE PROCEDURE dbo.CheckUser
    @Username NVARCHAR(50),
    @Password NVARCHAR(50)
AS
BEGIN
    SELECT * FROM Users WHERE Username = @Username AND Password = @Password
END
```

В C#:
```C#
string query = "dbo.CheckUser";
SqlCommand command = new SqlCommand(query, connection);
command.CommandType = CommandType.StoredProcedure;
command.Parameters.AddWithValue("@Username", username);
command.Parameters.AddWithValue("@Password", password);
```

3. Использование ORM (Object-Relational Mapping) библиотек, таких как Entity Framework, которые автоматически защищают от SQL injection.

Использование этих методов поможет защитить ваше приложение от SQL injection и обеспечить безопасность базы данных.
